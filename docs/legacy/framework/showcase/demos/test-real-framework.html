<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Native Web Components Framework - Real Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .status {
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        .pending {
            background: #fff3cd;
            color: #856404;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üß™ Native Web Components Framework - Real Module Test</h1>
    
    <div class="test-section">
        <h2>Module Import Test</h2>
        <div id="import-status" class="status pending">Loading framework modules...</div>
    </div>
    
    <div class="test-section">
        <h2>Component Test</h2>
        <div id="component-status" class="status pending">Creating test component...</div>
        <div id="component-demo"></div>
    </div>
    
    <div class="test-section">
        <h2>State Management Test</h2>
        <div id="state-status" class="status pending">Testing state management...</div>
        <pre id="state-output"></pre>
    </div>
    
    <div class="test-section">
        <h2>Router Test</h2>
        <div id="router-status" class="status pending">Testing router...</div>
        <div id="router-output"></div>
    </div>

    <script type="module">
        // Test real framework imports
        const testResults = [];
        
        function updateStatus(id, success, message) {
            const element = document.getElementById(id);
            element.className = `status ${success ? 'success' : 'error'}`;
            element.textContent = message;
            testResults.push({ test: id, success, message });
        }
        
        async function testFramework() {
            console.log('üöÄ Starting real framework tests...');
            
            // Test 1: Import Framework Core
            try {
                const { createFramework, defineComponent, NativeComponent } = await import('../../core/engine/framework-core.js');
                updateStatus('import-status', true, '‚úÖ Framework modules imported successfully!');
                
                // Create framework instance
                const framework = createFramework({
                    enableRouter: true,
                    enableStateManagement: true,
                    enablePerformanceMonitoring: true
                });
                
                // Test 2: Create Component
                try {
                    class TestComponent extends NativeComponent {
                        constructor() {
                            super();
                        }
                        
                        getTemplate() {
                            return `
                                <div style="padding: 20px; background: #e3f2fd; border-radius: 8px;">
                                    <h3>Native Test Component</h3>
                                    <p>Count: <span id="count">${this._state.count || 0}</span></p>
                                    <button id="increment">Increment</button>
                                </div>
                            `;
                        }
                        
                        getEvents() {
                            return {
                                '#increment': {
                                    click: () => {
                                        const currentCount = this._state.count || 0;
                                        this.setState({ count: currentCount + 1 });
                                        this.shadowRoot.querySelector('#count').textContent = currentCount + 1;
                                    }
                                }
                            };
                        }
                    }
                    
                    // Register component
                    defineComponent('TestComponent', TestComponent);
                    
                    // Create instance
                    const testEl = document.createElement('test-component');
                    document.getElementById('component-demo').appendChild(testEl);
                    
                    updateStatus('component-status', true, '‚úÖ Component created and rendered!');
                    
                } catch (error) {
                    updateStatus('component-status', false, `‚ùå Component error: ${error.message}`);
                }
                
                // Test 3: State Management
                try {
                    const { NativeStateStore } = await import('../../core/systems/state-manager.js');
                    
                    const store = new NativeStateStore({
                        user: 'Test User',
                        count: 0,
                        items: []
                    });
                    
                    // Subscribe to state changes
                    let stateUpdates = [];
                    store.subscribe((state) => {
                        stateUpdates.push(JSON.stringify(state, null, 2));
                    });
                    
                    // Update state
                    store.setState({ count: 1 });
                    store.setState({ items: ['item1', 'item2'] });
                    
                    document.getElementById('state-output').textContent = 
                        `Initial State:\n${JSON.stringify(store.getState(), null, 2)}\n\nUpdates: ${stateUpdates.length}`;
                    
                    updateStatus('state-status', true, '‚úÖ State management working!');
                    
                } catch (error) {
                    updateStatus('state-status', false, `‚ùå State error: ${error.message}`);
                }
                
                // Test 4: Router
                try {
                    const { NativeRouter } = await import('../../core/systems/router.js');
                    
                    const router = new NativeRouter({
                        enableHashRouting: false
                    });
                    
                    // Add routes
                    router.route('/', '<h4>Home Page</h4>', { lazy: false });
                    router.route('/about', '<h4>About Page</h4>', { lazy: false });
                    
                    document.getElementById('router-output').innerHTML = `
                        <p>Routes registered: ${router.routes.size}</p>
                        <p>Current path: ${window.location.pathname}</p>
                    `;
                    
                    updateStatus('router-status', true, '‚úÖ Router initialized with routes!');
                    
                } catch (error) {
                    updateStatus('router-status', false, `‚ùå Router error: ${error.message}`);
                }
                
                // Summary
                const successCount = testResults.filter(r => r.success).length;
                console.log(`\nüìä Test Summary: ${successCount}/${testResults.length} tests passed`);
                
            } catch (error) {
                updateStatus('import-status', false, `‚ùå Import error: ${error.message}`);
                console.error('Framework import error:', error);
            }
        }
        
        // Run tests
        testFramework();
    </script>
</body>
</html>