export{compose,c}from"./compose";export{withState,withEvents,withLifecycle,withProps,s,e,l,p}from"./behaviors";export function compose(...t){return o=>t.reduceRight((t,o)=>o(t),o)}export const c=compose;const t=new WeakMap,o=new WeakMap,n=new WeakMap;export function withState(o){return n=>{const r=void 0!==o.initial?o:{initial:o},i=new Proxy(r.initial,{set(t,o,i){const a={...t};return t[o]=i,r.onChange?.(t,a),n.update?.(),!0}});return t.set(n,i),n.state=i,n}}export function withEvents(t){return n=>{const r=new Map;return o.set(n,r),n.on=(t,o)=>(r.has(t)||(r.set(t,new Set),n.addEventListener(t,o=>{r.get(t)?.forEach(t=>t(o))})),r.get(t)?.add(o),n),n.off=(t,o)=>(r.get(t)?.delete(o),n),t&&Object.entries(t).forEach(([t,o])=>{n.on(t,o)}),n}}export function withLifecycle(t){return o=>{const r=new MutationObserver(n=>{n.forEach(n=>{n.addedNodes.forEach(n=>{n===o&&t.onMount?.()}),n.removedNodes.forEach(n=>{n===o&&(t.onUnmount?.(),r.disconnect())})})}),i=()=>{const t=o.parentNode||document.body;r.observe(t,{childList:!0,subtree:!0})};return o.mount=()=>(i(),t.onMount?.(),o),o.unmount=()=>(t.onUnmount?.(),r.disconnect(),n.delete(o),o),n.set(o,r),o.parentNode&&i(),o}}export function withProps(t){return o=>(o.props=new Proxy(t,{set:(t,n,r)=>("string"!=typeof r&&"number"!=typeof r&&"boolean"!=typeof r||o.setAttribute(String(n),String(r)),t[n]=r,!0)}),Object.entries(t).forEach(([t,n])=>{"string"!=typeof n&&"number"!=typeof n&&"boolean"!=typeof n||o.setAttribute(t,String(n))}),o)}export const s=withState;export const e=withEvents;export const l=withLifecycle;export const p=withProps;