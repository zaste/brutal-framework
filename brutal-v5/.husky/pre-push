#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🚀 Running pre-push checks..."

# 1. Full architecture alignment check
echo "🏛️ Checking architecture alignment..."
npm run check:architecture || {
  echo "❌ Architecture alignment check failed!"
  echo "Fix violations before pushing"
  exit 1
}

# 2. Build all packages
echo "🔨 Building all packages..."
npm run build || {
  echo "❌ Build failed!"
  exit 1
}

# 3. Size check
echo "📏 Checking bundle sizes..."
npm run size:check || {
  echo "❌ Bundle size limits exceeded!"
  exit 1
}

# 4. Full test suite
echo "🧪 Running full test suite..."
npm run test:all || {
  echo "❌ Tests failed!"
  exit 1
}

echo "✅ All pre-push checks passed!"