<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BRUTAL V4 - Simple Test</title>
    <style>
        body {
            background: #000;
            color: #fff;
            font-family: monospace;
            padding: 20px;
        }
        .log { margin: 5px 0; }
        .success { color: #0f0; }
        .error { color: #f00; }
    </style>
</head>
<body>
    <h1>BRUTAL V4 Simple Test</h1>
    <div id="log"></div>
    <div id="test-area" style="margin-top: 20px; padding: 20px; border: 1px solid #333;"></div>

    <script type="module">
        const log = document.getElementById('log');
        const testArea = document.getElementById('test-area');
        
        function addLog(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = message;
            log.appendChild(div);
            console.log(message);
        }
        
        try {
            // Test 1: Import main exports
            addLog('Testing main imports...');
            const { BrutalComponent, BrutalState, html } = await import('./index.js');
            addLog('✅ Main imports successful', 'success');
            
            // Test 2: Create a simple component
            addLog('Creating test component...');
            
            class SimpleTestComponent extends BrutalComponent {
                constructor() {
                    super();
                    this._state = new BrutalState({
                        count: 0,
                        message: 'Hello BRUTAL V4!'
                    });
                    
                    this._state.on('change', () => this.render());
                }
                
                createTemplate() {
                    const { count, message } = this._state.getAll();
                    return html`
                        <style>
                            :host {
                                display: block;
                                padding: 20px;
                                background: #1a1a1a;
                                border-radius: 8px;
                            }
                            button {
                                background: #f39c12;
                                border: none;
                                padding: 10px 20px;
                                border-radius: 4px;
                                color: #000;
                                font-weight: bold;
                                cursor: pointer;
                            }
                            button:hover {
                                background: #e67e22;
                            }
                        </style>
                        <div>
                            <h2>${message}</h2>
                            <p>Count: ${count}</p>
                            <button @click=${() => this.increment()}>Increment</button>
                        </div>
                    `;
                }
                
                increment() {
                    this._state.set({ count: this._state.get('count') + 1 });
                }
            }
            
            // Register component
            customElements.define('simple-test-component', SimpleTestComponent);
            addLog('✅ Component defined', 'success');
            
            // Create and add to DOM
            const component = document.createElement('simple-test-component');
            testArea.appendChild(component);
            addLog('✅ Component added to DOM', 'success');
            
            // Test 3: Import test system
            addLog('Testing test system imports...');
            const { BrutalTest, BrutalTestRunner } = await import('./testing/index.js');
            addLog('✅ Test system imports successful', 'success');
            
            // Create a simple test
            class QuickTest extends BrutalTest {
                async execute() {
                    this.assert(1 + 1 === 2, 'Basic math works');
                    this.assert(typeof BrutalComponent === 'function', 'BrutalComponent is a function');
                }
            }
            
            customElements.define('quick-test', QuickTest);
            
            // Add test to page
            const test = document.createElement('quick-test');
            testArea.appendChild(test);
            
            // Run test
            await test.run();
            const results = test.getResults();
            addLog(`✅ Test completed: ${results.passed ? 'PASSED' : 'FAILED'}`, results.passed ? 'success' : 'error');
            
        } catch (error) {
            addLog(`❌ Error: ${error.message}`, 'error');
            console.error(error);
        }
    </script>
</body>
</html>